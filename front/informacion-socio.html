<!DOCTYPE html>
<html>
  <head>
    <title>Información usuario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
    />
  </head>

  <body>
    <header>
      <!--header por header_footer.js-->
    </header>

    <section class="hero has-background-success">
      <div class="container my-6">
        <div class="notification has-background-light">
          <div class="columns">
            <!--COLUMNA DONDE VA LA INFO DEL SOCIO-->
            <div class="column">
              <div id="socio-info" class="content is-size-4 p-6 ml-6 has-text-weight-semibold has-text-dark">
                <!--ESTO ES COMO DEBERIA VERSE EN EL FRONT LA INFORMACION DEL SOCIO-->
                <!--<h1 class="title has-text-success">DATOS</h1>
                <div class="block">
                  <p>Id de Usuario: 6579881</p>
                </div>
                <div class="block">
                  <p>Nombre: Pepe</p>
                </div>
                <div class="block">
                  <p>Apellido: Argento</p>
                </div>
                <div class="block">
                  <p>Correo electrónico: lalagartijacosmica@gmail.com</p>
                </div>
                <div class="block">
                  <p>Domicilio: Bolívar 65</p>
                </div>
                <div class="block">
                  <p>Teléfono: +54 11 1234-5678</p>
                </div>-->
              </div>
            </div>

            <div class="column">
              <br />
              <p class="title has-text-centered">LIBRO EN PRESTACIÓN</p>
              <div class="card mx-6 my-2">
                <div class="card-content">
                  <p class="subtitle has-text-centered">
                    La historia Interminable
                  </p>
                </div>
                <div class="card-image">
                  <figure class="image">
                    <img
                      id="imagen-info-socios"
                      src="https://images.cdn1.buscalibre.com/fit-in/360x360/5b/18/5b18ed831bc8fbbac844f6a7bc5f9a51.jpg"
                      alt="'La historia interminable' de Michael Ende"
                    />
                  </figure>
                  <style>
                    #imagen-info-socios {
                      max-width: 100%;
                      height: 350px;
                      object-fit: cover;
                    }
                  </style>
                </div>
                <footer class="card-footer">
                  <a class="button is-fullwidth is-light" href="prestamo.html"
                    >Ver</a
                  >
                </footer>
              </div>
            </div>
          </div>
        </div>
      </div>
      <br />
    </section>
    <section class="hero is-warning">
      <div class="hero-body">
        <h1 class="title has-text-centered">Libros prestados anteriormente</h1>
        <div class="container is-max-tablet">
          <div class="notification">
            <div class="columns">
              <div class="column">
                <img
                  src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTmC4m3C4hk9soAR-pl9QDISZ5LLAHl5gjQgw&s"
                  width="100px"
                  length="100px"
                />
              </div>
              <div class="column">
                <img
                  src="https://images.cdn2.buscalibre.com/fit-in/360x360/e6/5f/e65f54742ad7bbc41903d17f75b77d78.jpg"
                  width="100px"
                  length="100px"
                />
              </div>
              <div class="column">
                <img
                  src="https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1532714506i/40961427.jpg"
                  width="100px"
                  length="100px"
                />
              </div>
              <div class="column">
                <img
                  src="https://tienda.planetadelibros.com.ar/cdn/shop/products/portada_el-principito_antoine-de-saint-exupery_201507152131.jpg?v=1684356025"
                  width="100px"
                  length="100px"
                />
              </div>
            </div>
          </div>
          <a class="button is-fullwidth" href="libros.html">Más libros</a>
        </div>
      </div>
    </section>

    <footer class="footer">
      <!--footer por header_footer.js-->
    </footer>
    <script src="./header_footer.js"></script>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const socioId = urlParams.get("id");
      if (!socioId) {
        alert("ID no válido");
        window.location.href = "buscar-socio.html"; // Redirige a la página de búsqueda si no se encuentra el ID
      } else {
        // Hacer el fetch al backend para obtener la información del socio
        fetch(`http://localhost:3000/socios/${socioId}`)
        .then((Response) => Response.json())
        .then(socio =>{
            const socioInfo = document.getElementById('socio-info');
            //Esta es la estructura donde van a mostrarse los datos del socio
            socioInfo.innerHTML = `
                <h1 class="title has-text-success">DATOS</h1>
                <div class="block">
                <p>Id de Usuario: ${socio.id}</p>
                </div>
                <div class="block">
                <p>Nombre: ${socio.nombre}</p>
                </div>
                <div class="block">
                <p>Apellido: ${socio.apellido}</p>
                </div>
                <div class="block">
                <p>Correo electrónico: ${socio.email}</p>
                </div>
                <div class="block">
                <p>Domicilio: ${socio.direccion}</p>
                </div>
                <div class="block">
                <p>Teléfono: ${socio.telefono}</p>
                </div>
            `;
        })
        .catch(error => {
          // Si el socio no existe en vez de mostrar todo la estructura html anterior, muestra un p con un mensaje
          document.getElementById('socio-info').innerHTML = `<p>"SOCIO NO ENCONTRADO"</p>`;
        });
      }
    </script>
  </body>
</html>
